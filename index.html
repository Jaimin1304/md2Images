<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Markdown to Image - 数学公式增强版</title>
    <link rel="stylesheet" href="styles.css" />

    <!-- KaTeX CSS for math formula rendering -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css"
    />

    <!-- Existing libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- KaTeX JavaScript libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
  </head>
  <body>
    <!-- 顶部工具栏 -->
    <div class="toolbar">
      <div class="toolbar-group">
        <label>Width:</label>
        <input
          type="range"
          id="widthSlider"
          min="300"
          max="1200"
          value="600"
          step="50"
        />
        <span id="widthValue">600px</span>
      </div>

      <div class="toolbar-group">
        <label>Theme:</label>
        <select id="themeSelector" onchange="changeTheme()">
          <option value="light">light</option>
          <option value="dark">dark</option>
        </select>
      </div>

      <div class="toolbar-group">
        <button onclick="insertDivider()">Add Cut Line</button>
        <button onclick="removeDividers()">Clear Lines</button>
      </div>

      <div class="toolbar-group" style="margin-left: auto">
        <button class="export-btn" onclick="exportImages()">
          📸 Export PNG
        </button>
      </div>
    </div>

    <!-- 主内容区域 -->
    <div class="main-container">
      <!-- 左侧输入面板 -->
      <div class="input-panel">
        <textarea
          class="input-textarea"
          id="markdownInput"
          oninput="updatePreview()"
        >
# Markdown to Image 转换工具

这是一个支持 **数学公式渲染** 的 Markdown 转图片工具，让您轻松将包含数学表达式的文本转换为精美图片。

## 主要功能

- ✨ **实时预览** - 输入 Markdown 文本，立即看到渲染效果
- 🎨 **主题选择** - 支持明亮和暗黑两种渲染风格
- 📏 **自定义宽度** - 300px 到 1200px 任意调节图片宽度
- ✂️ **智能分割** - 使用 `---` 分割线将长文分段导出
- 📦 **批量导出** - 自动打包为 ZIP 文件，方便下载
- 🔢 **数学公式** - 支持 LaTeX 数学表达式渲染

## 数学公式示例

### 行内公式
爱因斯坦的质能方程 \(E = mc^2\) 是物理学中最著名的公式之一。

### 块级公式
二次方程的求根公式：
\[
x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}
\]

### 复杂公式
正态分布的概率密度函数：
\[
f(x) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\]

---

## 使用方法

1. 在左侧编辑器中输入您的 Markdown 内容
2. 使用 `\( ... \)` 表示行内公式，`\[ ... \]` 表示块级公式
3. 右侧实时预览渲染效果
4. 调整图片宽度和主题风格
5. 点击 **Export PNG** 按钮导出图片
6. 输入 `---` 可以添加分割线，用于将长文档分段导出为多个图片文件
      </textarea
        >
      </div>

      <!-- 右侧预览面板 -->
      <div class="preview-panel">
        <div class="preview-content" id="previewContent">
          <div class="markdown-body" id="markdownOutput"></div>
          <div class="width-indicator" id="widthIndicator">600px</div>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
